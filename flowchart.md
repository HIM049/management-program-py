# 程序流程图

## 1. 主菜单 (`main.py` -> `menus/menu_main.py`)

*   **程序启动**
    *   `main_menu()` 循环：
        *   显示选项：
            *   "1. 库存管理"
            *   "2. 销售管理"
            *   "3. 退出"
        *   用户输入 (整数)
        *   **分支:**
            *   **输入 1:** 调用 `inventory_menu()` (进入库存管理菜单)
            *   **输入 2:** 调用 `sales_menu()` (进入销售管理菜单)
            *   **输入 3:** 退出程序
            *   **其他输入:** 打印 "未知选项"

## 2. 库存管理菜单 (`menus/menu_inventory.py`)

*   **主菜单 -> 输入 1 -> 库存菜单**
    *   `inventory_menu()` 循环：
        *   显示选项：
            *   "a. 查看/更新花卉"
            *   "b. 添加新花卉"
            *   "c. 查看/更新附加品"
            *   "d. 添加新附加品"
            *   "e. 返回主菜单"
        *   用户输入 (字符串，转换为大写)
        *   **分支:**
            *   **输入 'A':** 调用 `view_and_update_blooms()` (进入查看/更新花卉流程)
            *   **输入 'B':** 调用 `add_new_blooms()` (进入添加新花卉流程)
            *   **输入 'C':** 调用 `view_and_update_addons()` (进入查看/更新附加品流程)
            *   **输入 'D':** 调用 `add_new_addons()` (进入添加新附加品流程)
            *   **输入 'E':** 跳出循环，返回主菜单
            *   **其他输入:** 打印 "未知选项"

### 2.1. 添加新花卉 (`inventory/add_new_blooms.py`)

*   **库存菜单 -> 输入 'B' -> 添加新花卉**
    *   提示输入产品名称。
    *   提示输入产品代码 (如果为空则自动生成，并检查冲突)。
    *   提示输入产品价格。
    *   提示选择类别：
        *   "1. 浪漫"
        *   "2. 生日"
        *   "3. 开业"
        *   "4. 慰问"
        *   "5. 周年纪念"
        *   接受数字/首字母/全名。
    *   创建 `Product` 对象。
    *   将 `Product` 保存到存储。

### 2.2. 查看/更新花卉 (`inventory/view_and_update_blooms.py`)

*   **库存菜单 -> 输入 'A' -> 查看/更新花卉**
    *   以表格形式显示所有花卉。
    *   提示输入要更新的商品代码，或输入 '0' 返回。
    *   **分支:**
        *   **输入 '0':** 返回库存菜单。
        *   **商品代码未找到:** 打印 "未找到产品ID"，等待，然后返回。
        *   **商品代码找到:**
            *   以表格形式显示单个花卉。
            *   提示输入新价格 (或 '0' 跳过)。
            *   提示输入新的可用状态 (T/F，或跳过)。
            *   更新存储中的 `Product`。

### 2.3. 添加新附加品 (`inventory/add_new_addons.py`)

*   **库存菜单 -> 输入 'D' -> 添加新附加品**
    *   提示输入附加品名称。
    *   提示输入附加品代码 (如果为空则自动生成，并检查冲突)。
    *   提示输入附加品价格。
    *   创建 `Addon` 对象。
    *   将 `Addon` 保存到存储。

### 2.4. 查看/更新附加品 (`inventory/view_and_update_addons.py`)

*   **库存菜单 -> 输入 'C' -> 查看/更新附加品**
    *   以表格形式显示所有附加品。
    *   提示输入要更新的商品代码，或输入 '0' 返回。
    *   **分支:**
        *   **输入 '0':** 返回库存菜单。
        *   **商品代码未找到:** 打印 "未找到产品ID"，等待，然后返回。
        *   **商品代码找到:**
            *   以表格形式显示单个附加品。
            *   提示输入新价格 (或 '0' 跳过)。
            *   提示输入新的可用状态 (T/F，或跳过)。
            *   更新存储中的 `Addon`。

## 3. 销售管理菜单 (`menus/menu_sales.py`)

*   **主菜单 -> 输入 2 -> 销售菜单**
    *   `sales_menu()` 循环：
        *   显示选项：
            *   "a. 创建订单"
            *   "b. 查看订单"
            *   "e. 返回主菜单"
        *   用户输入 (字符串，转换为大写)
        *   **分支:**
            *   **输入 'A':** 调用 `create_new_order()` (进入创建订单流程)
            *   **输入 'B':** 调用 `view_and_edit_order()` (进入查看/编辑订单流程)
            *   **输入 'E':** 跳出循环，返回主菜单
            *   **其他输入:** 打印 "未知选项"

### 3.1. 创建订单 (`sales/create_order.py`)

*   **销售菜单 -> 输入 'A' -> 创建订单**
    *   订单创建循环：
        *   显示产品列表 (可选择按类别过滤和按价格排序)。
        *   显示选项：
            *   "1. 按类别筛选产品"
            *   "2. 按价格排序产品"
            *   "3. 订购商品"
            *   "0. 返回"
        *   用户输入：
        *   **分支:**
            *   **输入 '1':** 选择类别 (浪漫、生日等，或 "0. 返回" 清除筛选)。
            *   **输入 '2':** 切换按价格排序。
            *   **输入 '3':** 调用 `order_item()` (进入订单商品详情输入流程)
            *   **输入 '0':** 跳出循环，返回销售菜单。
            *   **其他输入:** 打印 "未知选项"
    *   `order_item()` (订单商品详情输入流程):
        *   提示输入产品商品代码。
        *   提示输入附加品商品代码 (或 '0' 跳过)。
        *   提示输入客户姓名。
        *   提示输入收件人姓名。
        *   提示输入留言 (最多 300 字符)。
        *   提示选择配送选项 ("门店自取" 或 "配送")。
            *   **分支:**
                *   **选择 "配送":** 提示输入地址和日期。
        *   显示订单摘要。
        *   提示确认 ("确认", "编辑信息", "取消")。
        *   **分支:**
            *   **选择 "确认":** 将 `OrderDetails` 保存到存储，然后返回。
            *   **选择 "编辑信息":** 重新开始 `order_item()` 输入过程。
            *   **选择 "取消":** 不保存并返回。

### 3.2. 查看和编辑订单 (`sales/view_and_edit_order.py`)

*   **销售菜单 -> 输入 'B' -> 查看和编辑订单**
    *   查看/编辑订单循环：
        *   以表格形式显示订单 (按状态筛选，默认为 "开放")。
        *   显示选项：
            *   "1. 编辑/取消订单"
            *   "2. 按状态筛选订单"
            *   "0. 返回主菜单"
        *   用户输入：
        *   **分支:**
            *   **输入 '0':** 调用 `set_order()` (进入设置订单状态流程)
            *   **输入 '1':** 调用 `set_filter()` (进入设置订单筛选流程)
            *   **输入 'None' (来自 input_option 取消):** 跳出循环，返回销售菜单。
    *   `set_order()` (设置订单状态流程):
        *   提示输入订单号。
        *   **分支:**
            *   **订单未找到:** 打印 "未找到商品"，继续循环。
            *   **订单找到:**
                *   根据当前订单状态，显示更改状态的选项 (例如，"取消订单", "更改为准备中", "更改为就绪", "更改为已关闭", "设置回开放")。
                *   用户输入选择新状态或取消。
                *   更新存储中的订单状态。
                *   跳出循环，返回 `view_and_edit_order()` 循环。
    *   `set_filter()` (设置订单筛选流程):
        *   显示订单状态筛选选项：
            *   "开放"
            *   "已取消"
            *   "准备中"
            *   "就绪"
            *   "已关闭"
        *   用户输入选择筛选器。
        *   返回选定的 `OrderStatus`。
